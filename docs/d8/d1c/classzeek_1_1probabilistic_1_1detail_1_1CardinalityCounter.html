<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>zeek: zeek::probabilistic::detail::CardinalityCounter Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">zeek
   &#160;<span id="projectnumber">4.2.0</span>
   </div>
   <div id="projectbrief">github.com/zeek/zeek</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d5/d36/namespacezeek.html">zeek</a></li><li class="navelem"><a class="el" href="../../d1/dbd/namespacezeek_1_1probabilistic.html">probabilistic</a></li><li class="navelem"><a class="el" href="../../df/dde/namespacezeek_1_1probabilistic_1_1detail.html">detail</a></li><li class="navelem"><a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html">CardinalityCounter</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../de/d44/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">zeek::probabilistic::detail::CardinalityCounter Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../d5/dcd/CardinalityCounter_8h_source.html">CardinalityCounter.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a20be2ac03da1e885da325c43dc91a15a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html#a20be2ac03da1e885da325c43dc91a15a">CardinalityCounter</a> (double error_margin, double confidence=0.95)</td></tr>
<tr class="separator:a20be2ac03da1e885da325c43dc91a15a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeed2cfa565ef6c1cc49886dc526ae7b1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html#aeed2cfa565ef6c1cc49886dc526ae7b1">CardinalityCounter</a> (<a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html">CardinalityCounter</a> &amp;other)</td></tr>
<tr class="separator:aeed2cfa565ef6c1cc49886dc526ae7b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac73d265f002e36bbd51044f7bf54c618"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html#ac73d265f002e36bbd51044f7bf54c618">CardinalityCounter</a> (<a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html">CardinalityCounter</a> &amp;&amp;o) noexcept</td></tr>
<tr class="separator:ac73d265f002e36bbd51044f7bf54c618"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa8cc20442b7673b17d0fcf366ddd459"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html#afa8cc20442b7673b17d0fcf366ddd459">CardinalityCounter</a> (uint64_t size)</td></tr>
<tr class="separator:afa8cc20442b7673b17d0fcf366ddd459"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fa19e65b8f7bb3e5946104de24aba80"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html#a8fa19e65b8f7bb3e5946104de24aba80">~CardinalityCounter</a> ()</td></tr>
<tr class="separator:a8fa19e65b8f7bb3e5946104de24aba80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03dad1cabceed6f278511db763ecc629"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html#a03dad1cabceed6f278511db763ecc629">AddElement</a> (uint64_t hash)</td></tr>
<tr class="separator:a03dad1cabceed6f278511db763ecc629"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad18034ffc1729768e334554221aa9ea2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html#ad18034ffc1729768e334554221aa9ea2">Size</a> () const</td></tr>
<tr class="separator:ad18034ffc1729768e334554221aa9ea2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ee5775be58430fc3395c49268664a49"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html#a0ee5775be58430fc3395c49268664a49">Merge</a> (<a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html">CardinalityCounter</a> *c)</td></tr>
<tr class="separator:a0ee5775be58430fc3395c49268664a49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3615fb34f0f92c132f52093c35e97892"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/d21/namespacebroker.html#d8/dc8/classbroker_1_1expected">broker::expected</a>&lt; broker::data &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html#a3615fb34f0f92c132f52093c35e97892">Serialize</a> () const</td></tr>
<tr class="separator:a3615fb34f0f92c132f52093c35e97892"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a1464a47984a924b93afb1d3d13eb50d6"><td class="memItemLeft" align="right" valign="top">static std::unique_ptr&lt; <a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html">CardinalityCounter</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html#a1464a47984a924b93afb1d3d13eb50d6">Unserialize</a> (const broker::data &amp;data)</td></tr>
<tr class="separator:a1464a47984a924b93afb1d3d13eb50d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:afcc5fc57c2162e076f9b9dfbb5995593"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html#afcc5fc57c2162e076f9b9dfbb5995593">GetM</a> () const</td></tr>
<tr class="separator:afcc5fc57c2162e076f9b9dfbb5995593"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2e93ddadba9dd34a7a1b5f35ea7308d"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; uint8_t &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html#ab2e93ddadba9dd34a7a1b5f35ea7308d">GetBuckets</a> () const</td></tr>
<tr class="separator:ab2e93ddadba9dd34a7a1b5f35ea7308d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ad16e9ffec3904e4de17d4311c4644f62"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html#ad16e9ffec3904e4de17d4311c4644f62">CardinalityCounter</a> (uint64_t size, uint64_t <a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html#a57383a62b8fa8c41fbc9943c27b37dba">V</a>, double <a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html#aa5ab19a5de71cc4b22fb3a86630f4784">alpha_m</a>)</td></tr>
<tr class="separator:ad16e9ffec3904e4de17d4311c4644f62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6360dbdb1e702fe0456e7d7ae1af757f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html#a6360dbdb1e702fe0456e7d7ae1af757f">Init</a> (uint64_t arg_size)</td></tr>
<tr class="separator:a6360dbdb1e702fe0456e7d7ae1af757f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31fd1760b6110d76c3bf7a54f1159fa9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html#a31fd1760b6110d76c3bf7a54f1159fa9">OptimalB</a> (double error, double confidence) const</td></tr>
<tr class="separator:a31fd1760b6110d76c3bf7a54f1159fa9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab94982a2ef5c4625bd63038d0990c0bf"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html#ab94982a2ef5c4625bd63038d0990c0bf">Rank</a> (uint64_t hash_modified) const</td></tr>
<tr class="separator:ab94982a2ef5c4625bd63038d0990c0bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:a0f4eabafba7d0b963bfe8feb996a42ce"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html#a0f4eabafba7d0b963bfe8feb996a42ce">flsll</a> (uint64_t mask)</td></tr>
<tr class="separator:a0f4eabafba7d0b963bfe8feb996a42ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a4e8c4b4c5840e30ba743d2a81d75c66a"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html#a4e8c4b4c5840e30ba743d2a81d75c66a">m</a></td></tr>
<tr class="separator:a4e8c4b4c5840e30ba743d2a81d75c66a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a6e3fddbb0e1b320a0a61e103967f91"><td class="memItemLeft" align="right" valign="top">std::vector&lt; uint8_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html#a9a6e3fddbb0e1b320a0a61e103967f91">buckets</a></td></tr>
<tr class="separator:a9a6e3fddbb0e1b320a0a61e103967f91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57383a62b8fa8c41fbc9943c27b37dba"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html#a57383a62b8fa8c41fbc9943c27b37dba">V</a></td></tr>
<tr class="separator:a57383a62b8fa8c41fbc9943c27b37dba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5ab19a5de71cc4b22fb3a86630f4784"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html#aa5ab19a5de71cc4b22fb3a86630f4784">alpha_m</a></td></tr>
<tr class="separator:aa5ab19a5de71cc4b22fb3a86630f4784"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab709465985fbd1920d086202154e188f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html#ab709465985fbd1920d086202154e188f">p</a></td></tr>
<tr class="separator:ab709465985fbd1920d086202154e188f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A probabilistic cardinality counter using the HyperLogLog algorithm. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a20be2ac03da1e885da325c43dc91a15a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20be2ac03da1e885da325c43dc91a15a">&#9670;&nbsp;</a></span>CardinalityCounter() <span class="overload">[1/5]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">zeek::probabilistic::detail::CardinalityCounter::CardinalityCounter </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>error_margin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>confidence</em> = <code>0.95</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructor.</p>
<p>The number of buckets of the data structure is determined using the error margin and the given confidence.</p>
<p>For example, assume an error_margin of 2% and a confidence of 95%. If the Size function returns an estimate of 100, this means that we are 95% sure that the cardinality is between 98 and 102.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">error_margin</td><td>error margin</td></tr>
    <tr><td class="paramname">confidence</td><td>confidence of the error. Default: 0.95 </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aeed2cfa565ef6c1cc49886dc526ae7b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeed2cfa565ef6c1cc49886dc526ae7b1">&#9670;&nbsp;</a></span>CardinalityCounter() <span class="overload">[2/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">zeek::probabilistic::detail::CardinalityCounter::CardinalityCounter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html">CardinalityCounter</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Copy-Constructor </p>

</div>
</div>
<a id="ac73d265f002e36bbd51044f7bf54c618"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac73d265f002e36bbd51044f7bf54c618">&#9670;&nbsp;</a></span>CardinalityCounter() <span class="overload">[3/5]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">zeek::probabilistic::detail::CardinalityCounter::CardinalityCounter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html">CardinalityCounter</a> &amp;&amp;&#160;</td>
          <td class="paramname"><em>o</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Move-Constructor </p>

</div>
</div>
<a id="afa8cc20442b7673b17d0fcf366ddd459"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa8cc20442b7673b17d0fcf366ddd459">&#9670;&nbsp;</a></span>CardinalityCounter() <span class="overload">[4/5]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">zeek::probabilistic::detail::CardinalityCounter::CardinalityCounter </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructor for a known number of buckets.</p>
<p>The error margin is 1.04/sqrt(size) with approximately 68% probability.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>number of buckets to create </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8fa19e65b8f7bb3e5946104de24aba80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fa19e65b8f7bb3e5946104de24aba80">&#9670;&nbsp;</a></span>~CardinalityCounter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">zeek::probabilistic::detail::CardinalityCounter::~CardinalityCounter </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Destructor. </p>

</div>
</div>
<a id="ad16e9ffec3904e4de17d4311c4644f62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad16e9ffec3904e4de17d4311c4644f62">&#9670;&nbsp;</a></span>CardinalityCounter() <span class="overload">[5/5]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">zeek::probabilistic::detail::CardinalityCounter::CardinalityCounter </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha_m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructor used when unserializing, i.e., all parameters are known. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a03dad1cabceed6f278511db763ecc629"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03dad1cabceed6f278511db763ecc629">&#9670;&nbsp;</a></span>AddElement()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zeek::probabilistic::detail::CardinalityCounter::AddElement </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>hash</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a new element to the counter.</p>
<p>The hash function generating the hashes needs to be uniformly distributed over 64 bits.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hash</td><td>64-bit hash value of the element to be added </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0f4eabafba7d0b963bfe8feb996a42ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f4eabafba7d0b963bfe8feb996a42ce">&#9670;&nbsp;</a></span>flsll()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int zeek::probabilistic::detail::CardinalityCounter::flsll </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>mask</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>flsll from FreeBSD; especially Linux does not have this.</p>
<p>The following function is copied from libc/string/flsll.c from the FreeBSD source tree. Original copyright message follows </p>

</div>
</div>
<a id="ab2e93ddadba9dd34a7a1b5f35ea7308d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2e93ddadba9dd34a7a1b5f35ea7308d">&#9670;&nbsp;</a></span>GetBuckets()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; uint8_t &gt; &amp; zeek::probabilistic::detail::CardinalityCounter::GetBuckets </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the buckets array that holds all of the rough cardinality estimates.</p>
<p>Use <a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html#afcc5fc57c2162e076f9b9dfbb5995593">GetM()</a> to determine the size.</p>
<dl class="section return"><dt>Returns</dt><dd>Array containing cardinality estimates </dd></dl>

</div>
</div>
<a id="afcc5fc57c2162e076f9b9dfbb5995593"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcc5fc57c2162e076f9b9dfbb5995593">&#9670;&nbsp;</a></span>GetM()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t zeek::probabilistic::detail::CardinalityCounter::GetM </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return the number of buckets.</p>
<dl class="section return"><dt>Returns</dt><dd>Number of buckets </dd></dl>

</div>
</div>
<a id="a6360dbdb1e702fe0456e7d7ae1af757f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6360dbdb1e702fe0456e7d7ae1af757f">&#9670;&nbsp;</a></span>Init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void zeek::probabilistic::detail::CardinalityCounter::Init </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>arg_size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Helper function with code used jointly by multiple constructors.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arg_size</td><td>number of buckets that need to be kept </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0ee5775be58430fc3395c49268664a49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ee5775be58430fc3395c49268664a49">&#9670;&nbsp;</a></span>Merge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool zeek::probabilistic::detail::CardinalityCounter::Merge </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html">CardinalityCounter</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Merges the argument cardinality counter with this one. The error margins of both counters have to be the same, otherwhise the merge operation will not be carried out.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>Cardinality counter to merge into the current counter.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if successful </dd></dl>

</div>
</div>
<a id="a31fd1760b6110d76c3bf7a54f1159fa9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31fd1760b6110d76c3bf7a54f1159fa9">&#9670;&nbsp;</a></span>OptimalB()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int zeek::probabilistic::detail::CardinalityCounter::OptimalB </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>confidence</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This function calculates the smallest value of b that will satisfy these the constraints of a specified error margin and confidence level.</p>
<p>The exact expression for b is as follows: Define x = 2*(log(1.04*k/error)/log(2)). Then b is the ceiling of x.</p>
<p>After that initial estimate, the value of b is increased until the standard deviation falls within the specified valud.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">error</td><td>error margin</td></tr>
    <tr><td class="paramname">confidence</td><td>confidence of the error</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>minimal B-value satisfying the error-rate under confidence. </dd></dl>

</div>
</div>
<a id="ab94982a2ef5c4625bd63038d0990c0bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab94982a2ef5c4625bd63038d0990c0bf">&#9670;&nbsp;</a></span>Rank()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t zeek::probabilistic::detail::CardinalityCounter::Rank </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>hash_modified</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Determines at which index (counted from the front) the first one-bit appears. The last b bits have to be 0 (the element has to be divisible by m), hence they are ignored. Always adds 1 to the result. This is the rho function from the original algorithm.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hash_modified</td><td>hash value</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>index of first one-bit </dd></dl>

</div>
</div>
<a id="a3615fb34f0f92c132f52093c35e97892"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3615fb34f0f92c132f52093c35e97892">&#9670;&nbsp;</a></span>Serialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/d21/namespacebroker.html#d8/dc8/classbroker_1_1expected">broker::expected</a>&lt; broker::data &gt; zeek::probabilistic::detail::CardinalityCounter::Serialize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad18034ffc1729768e334554221aa9ea2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad18034ffc1729768e334554221aa9ea2">&#9670;&nbsp;</a></span>Size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double zeek::probabilistic::detail::CardinalityCounter::Size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the current estimated number of elements in the data structure</p>
<dl class="section return"><dt>Returns</dt><dd>Estimated number of elements</dd></dl>
<p>Estimate the size by using the the "raw" HyperLogLog estimate. Then, check if it's too "large" or "small" because the raw estimate doesn't do well in those cases. Thus, we correct for those errors as specified in the paper.</p>
<p>Note - we deviate from the HLL algorithm in the paper here, because of our 64-bit hashes. </p>

</div>
</div>
<a id="a1464a47984a924b93afb1d3d13eb50d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1464a47984a924b93afb1d3d13eb50d6">&#9670;&nbsp;</a></span>Unserialize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt; <a class="el" href="../../d8/d1c/classzeek_1_1probabilistic_1_1detail_1_1CardinalityCounter.html">CardinalityCounter</a> &gt; zeek::probabilistic::detail::CardinalityCounter::Unserialize </td>
          <td>(</td>
          <td class="paramtype">const broker::data &amp;&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="aa5ab19a5de71cc4b22fb3a86630f4784"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5ab19a5de71cc4b22fb3a86630f4784">&#9670;&nbsp;</a></span>alpha_m</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double zeek::probabilistic::detail::CardinalityCounter::alpha_m</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9a6e3fddbb0e1b320a0a61e103967f91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a6e3fddbb0e1b320a0a61e103967f91">&#9670;&nbsp;</a></span>buckets</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;uint8_t&gt; zeek::probabilistic::detail::CardinalityCounter::buckets</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>These are the actual buckets that are storing an estimate of the cardinality. All these need to do is count when the first 1 bit appears in the bitstring and that location is at most 65, so not that many bits are needed to store it. </p>

</div>
</div>
<a id="a4e8c4b4c5840e30ba743d2a81d75c66a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e8c4b4c5840e30ba743d2a81d75c66a">&#9670;&nbsp;</a></span>m</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t zeek::probabilistic::detail::CardinalityCounter::m</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This is the number of buckets that will be stored. The standard error is 1.04/sqrt(m), so the actual cardinality will be the estimate +/- 1.04/sqrt(m) with approximately 68% probability. </p>

</div>
</div>
<a id="ab709465985fbd1920d086202154e188f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab709465985fbd1920d086202154e188f">&#9670;&nbsp;</a></span>p</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int zeek::probabilistic::detail::CardinalityCounter::p</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a57383a62b8fa8c41fbc9943c27b37dba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57383a62b8fa8c41fbc9943c27b37dba">&#9670;&nbsp;</a></span>V</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t zeek::probabilistic::detail::CardinalityCounter::V</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>There are some state constants that need to be kept track of to make the final estimate easier. V is the number of values in buckets that are 0 and this is used in the small error correction. alpha_m is a multiplicative constant used in the algorithm. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/root/zeek/src/probabilistic/<a class="el" href="../../d5/dcd/CardinalityCounter_8h_source.html">CardinalityCounter.h</a></li>
<li>/root/zeek/src/probabilistic/<a class="el" href="../../d6/dcd/CardinalityCounter_8cc.html">CardinalityCounter.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
