<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>zeek: zeek::packet_analysis::IPTunnel Namespace Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">zeek
   &#160;<span id="projectnumber">4.2.0</span>
   </div>
   <div id="projectbrief">github.com/zeek/zeek</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d5/d36/namespacezeek.html">zeek</a></li><li class="navelem"><a class="el" href="../../d3/d17/namespacezeek_1_1packet__analysis.html">packet_analysis</a></li><li class="navelem"><a class="el" href="../../dd/d0c/namespacezeek_1_1packet__analysis_1_1IPTunnel.html">IPTunnel</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">zeek::packet_analysis::IPTunnel Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:da/d42/namespacezeek_1_1packet__analysis_1_1IPTunnel_1_1detail"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d42/namespacezeek_1_1packet__analysis_1_1IPTunnel_1_1detail.html">detail</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d74/classzeek_1_1packet__analysis_1_1IPTunnel_1_1IPTunnelAnalyzer.html">IPTunnelAnalyzer</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a15b94bcf19701e482fbf33c17cf6a638"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="../../d9/d2a/classzeek_1_1Packet.html">Packet</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d0c/namespacezeek_1_1packet__analysis_1_1IPTunnel.html#a15b94bcf19701e482fbf33c17cf6a638">build_inner_packet</a> (<a class="el" href="../../d9/d2a/classzeek_1_1Packet.html">Packet</a> *outer_pkt, int *encap_index, std::shared_ptr&lt; <a class="el" href="../../d9/dcc/classzeek_1_1EncapsulationStack.html">EncapsulationStack</a> &gt; encap_stack, uint32_t len, const u_char *data, int link_type, BifEnum::Tunnel::Type tunnel_type, const <a class="el" href="../../d3/dd0/classzeek_1_1Tag.html">Tag</a> &amp;analyzer_tag)</td></tr>
<tr class="separator:a15b94bcf19701e482fbf33c17cf6a638"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:af0b10ca5b4f1441777fe18be962b7fbc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/d74/classzeek_1_1packet__analysis_1_1IPTunnel_1_1IPTunnelAnalyzer.html">IPTunnelAnalyzer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d0c/namespacezeek_1_1packet__analysis_1_1IPTunnel.html#af0b10ca5b4f1441777fe18be962b7fbc">ip_tunnel_analyzer</a></td></tr>
<tr class="separator:af0b10ca5b4f1441777fe18be962b7fbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a15b94bcf19701e482fbf33c17cf6a638"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15b94bcf19701e482fbf33c17cf6a638">&#9670;&nbsp;</a></span>build_inner_packet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt; <a class="el" href="../../d9/d2a/classzeek_1_1Packet.html">Packet</a> &gt; zeek::packet_analysis::IPTunnel::build_inner_packet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/d2a/classzeek_1_1Packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>outer_pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>encap_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="../../d9/dcc/classzeek_1_1EncapsulationStack.html">EncapsulationStack</a> &gt;&#160;</td>
          <td class="paramname"><em>encap_stack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const u_char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>link_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BifEnum::Tunnel::Type&#160;</td>
          <td class="paramname"><em>tunnel_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d3/dd0/classzeek_1_1Tag.html">Tag</a> &amp;&#160;</td>
          <td class="paramname"><em>analyzer_tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Utility function for packet analyzers for encapsulation/tunnel protocols. This builds a new packet object containing the encapsulated/tunneled packet, as well as adding to the associated encapsulation stack for the tunnel.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">outer_pkt</td><td>The packet containing the encapsulation. This packet should contain </td></tr>
    <tr><td class="paramname">encap_index</td><td>A return value for the current index into the encapsulation stack. This is returned to allow analzyers to know what point in the stack they were operating on as the packet analysis chain unwinds as it returns. </td></tr>
    <tr><td class="paramname">encap_stack</td><td>Tracks the encapsulations as the new encapsulations are discovered in the inner packets. </td></tr>
    <tr><td class="paramname">len</td><td>The byte length of the packet data containing in the inner packet. </td></tr>
    <tr><td class="paramname">data</td><td>A pointer to the first byte of the inner packet. </td></tr>
    <tr><td class="paramname">link_type</td><td>The link type (DLT_*) for the outer packet. If not known, DLT_RAW can be passed for this value. </td></tr>
    <tr><td class="paramname">tunnel_type</td><td>The type of tunnel the inner packet is stored in. </td></tr>
    <tr><td class="paramname">analyzer_tag</td><td>The tag for the analyzer calling this method. return A new packet object describing the encapsulated packet and data. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="af0b10ca5b4f1441777fe18be962b7fbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0b10ca5b4f1441777fe18be962b7fbc">&#9670;&nbsp;</a></span>ip_tunnel_analyzer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/d74/classzeek_1_1packet__analysis_1_1IPTunnel_1_1IPTunnelAnalyzer.html">IPTunnelAnalyzer</a> * zeek::packet_analysis::IPTunnel::ip_tunnel_analyzer</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
