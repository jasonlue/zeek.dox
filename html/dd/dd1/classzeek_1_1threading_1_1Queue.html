<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>zeek: zeek::threading::Queue&lt; T &gt; Class Template Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">zeek
   &#160;<span id="projectnumber">4.2.0</span>
   </div>
   <div id="projectbrief">github.com/zeek/zeek</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d5/d36/namespacezeek.html">zeek</a></li><li class="navelem"><a class="el" href="../../dd/df9/namespacezeek_1_1threading.html">threading</a></li><li class="navelem"><a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html">Queue</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="../../de/da5/classzeek_1_1threading_1_1Queue-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">zeek::threading::Queue&lt; T &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../db/d7a/threading_2Queue_8h_source.html">Queue.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for zeek::threading::Queue&lt; T &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/d6c/classzeek_1_1threading_1_1Queue__coll__graph.png" border="0" usemap="#azeek_1_1threading_1_1Queue_3_01T_01_4_coll__map" alt="Collaboration graph"/></div>
<map name="azeek_1_1threading_1_1Queue_3_01T_01_4_coll__map" id="azeek_1_1threading_1_1Queue_3_01T_01_4_coll__map">
<area shape="rect" title=" " alt="" coords="5,109,216,136"/>
<area shape="rect" href="../../d3/dd9/classzeek_1_1threading_1_1BasicThread.html" title=" " alt="" coords="5,5,216,32"/>
</map>
<center><span class="legend">[<a href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:dc/d12/structzeek_1_1threading_1_1Queue_1_1Stats"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#dc/d12/structzeek_1_1threading_1_1Queue_1_1Stats">Stats</a></td></tr>
<tr class="separator:dc/d12/structzeek_1_1threading_1_1Queue_1_1Stats"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad4129aa7dce3618a3ceb38daa7509667"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#ad4129aa7dce3618a3ceb38daa7509667">Queue</a> (<a class="el" href="../../d3/dd9/classzeek_1_1threading_1_1BasicThread.html">BasicThread</a> *arg_reader, <a class="el" href="../../d3/dd9/classzeek_1_1threading_1_1BasicThread.html">BasicThread</a> *arg_writer)</td></tr>
<tr class="separator:ad4129aa7dce3618a3ceb38daa7509667"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd54229d9c319ffc7936fd67288c417a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#abd54229d9c319ffc7936fd67288c417a">~Queue</a> ()</td></tr>
<tr class="separator:abd54229d9c319ffc7936fd67288c417a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ab27903a2888ca6b783dd9475d773e2"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#a2ab27903a2888ca6b783dd9475d773e2">Get</a> ()</td></tr>
<tr class="separator:a2ab27903a2888ca6b783dd9475d773e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f0111fb50c4fdd8703a8c2bc4d945f6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#a1f0111fb50c4fdd8703a8c2bc4d945f6">Put</a> (T data)</td></tr>
<tr class="separator:a1f0111fb50c4fdd8703a8c2bc4d945f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20a43630a2e24bcfe03cf899056daed0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#a20a43630a2e24bcfe03cf899056daed0">Ready</a> ()</td></tr>
<tr class="separator:a20a43630a2e24bcfe03cf899056daed0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a809c05aa6cbbfd87e78a72ebbdceed5b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#a809c05aa6cbbfd87e78a72ebbdceed5b">MaybeReady</a> ()</td></tr>
<tr class="separator:a809c05aa6cbbfd87e78a72ebbdceed5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63519d754733c6706b1bfea2a6027c2d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#a63519d754733c6706b1bfea2a6027c2d">WakeUp</a> ()</td></tr>
<tr class="separator:a63519d754733c6706b1bfea2a6027c2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af73087b9d59a21825e959003864c9a02"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#af73087b9d59a21825e959003864c9a02">Size</a> ()</td></tr>
<tr class="separator:af73087b9d59a21825e959003864c9a02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ea4414e72a215078b67d96cfdc54233"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#a7ea4414e72a215078b67d96cfdc54233">GetStats</a> (<a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#dc/d12/structzeek_1_1threading_1_1Queue_1_1Stats">Stats</a> *stats)</td></tr>
<tr class="separator:a7ea4414e72a215078b67d96cfdc54233"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a4a679929ea52b2151d519c856df434c9"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::unique_lock&lt; std::mutex &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#a4a679929ea52b2151d519c856df434c9">LocksForAllQueues</a> ()</td></tr>
<tr class="separator:a4a679929ea52b2151d519c856df434c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a27e7cca9388d3f4dff9f6e007e453b8c"><td class="memItemLeft" align="right" valign="top">std::mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#a27e7cca9388d3f4dff9f6e007e453b8c">mutex</a> [<a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#a7afbd89d22346851ec0caa1ae7d4e547">NUM_QUEUES</a>]</td></tr>
<tr class="separator:a27e7cca9388d3f4dff9f6e007e453b8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae18e6e465f1d2c5b865df959cf01977c"><td class="memItemLeft" align="right" valign="top">std::condition_variable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#ae18e6e465f1d2c5b865df959cf01977c">has_data</a> [<a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#a7afbd89d22346851ec0caa1ae7d4e547">NUM_QUEUES</a>]</td></tr>
<tr class="separator:ae18e6e465f1d2c5b865df959cf01977c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a107c47a5ed4d3dd0fef8a51af629befd"><td class="memItemLeft" align="right" valign="top">std::queue&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#a107c47a5ed4d3dd0fef8a51af629befd">messages</a> [<a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#a7afbd89d22346851ec0caa1ae7d4e547">NUM_QUEUES</a>]</td></tr>
<tr class="separator:a107c47a5ed4d3dd0fef8a51af629befd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6d787a4235e1705b49e96dc08375cb5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#ad6d787a4235e1705b49e96dc08375cb5">read_ptr</a></td></tr>
<tr class="separator:ad6d787a4235e1705b49e96dc08375cb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81e668042a80a20af0f61154acd0d4fd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#a81e668042a80a20af0f61154acd0d4fd">write_ptr</a></td></tr>
<tr class="separator:a81e668042a80a20af0f61154acd0d4fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43e75969c20576fbc132d40081f63983"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d3/dd9/classzeek_1_1threading_1_1BasicThread.html">BasicThread</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#a43e75969c20576fbc132d40081f63983">reader</a></td></tr>
<tr class="separator:a43e75969c20576fbc132d40081f63983"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbb4d8df360a3bfccaba747388882fc0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d3/dd9/classzeek_1_1threading_1_1BasicThread.html">BasicThread</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#acbb4d8df360a3bfccaba747388882fc0">writer</a></td></tr>
<tr class="separator:acbb4d8df360a3bfccaba747388882fc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9fdc030b2c7924fe4d0fe5569beabee"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#ae9fdc030b2c7924fe4d0fe5569beabee">num_reads</a></td></tr>
<tr class="separator:ae9fdc030b2c7924fe4d0fe5569beabee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8c6521a9090d3ca77490c84a0d09a16"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#ae8c6521a9090d3ca77490c84a0d09a16">num_writes</a></td></tr>
<tr class="separator:ae8c6521a9090d3ca77490c84a0d09a16"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:a7afbd89d22346851ec0caa1ae7d4e547"><td class="memItemLeft" align="right" valign="top">static const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#a7afbd89d22346851ec0caa1ae7d4e547">NUM_QUEUES</a> = 8</td></tr>
<tr class="separator:a7afbd89d22346851ec0caa1ae7d4e547"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename T&gt;<br />
class zeek::threading::Queue&lt; T &gt;</h3>

<p>A thread-safe single-reader single-writer queue.</p>
<p>The implementation uses multiple queues and reads/writes in rotary fashion in an attempt to limit contention.</p>
<p>All <a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html">Queue</a> instances must be instantiated by Zeek's main thread.</p>
<p>TODO: Unclear how critical performance is for this qeueue. We could likely optimize it further if helpful. </p>
</div><hr/><h2 class="groupheader">Class Documentation</h2>
<a name="dc/d12/structzeek_1_1threading_1_1Queue_1_1Stats" id="dc/d12/structzeek_1_1threading_1_1Queue_1_1Stats"></a>
<h2 class="memtitle"><span class="permalink"><a href="#dc/d12/structzeek_1_1threading_1_1Queue_1_1Stats">&#9670;&nbsp;</a></span>zeek::threading::Queue::Stats</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct zeek::threading::Queue::Stats</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><h3>template&lt;typename T&gt;<br />
struct zeek::threading::Queue&lt; T &gt;::Stats</h3>

<p>Statistics about inter-thread communication. </p>
</div><table class="fieldtable">
<tr><th colspan="3">Class Members</th></tr>
<tr><td class="fieldtype">
<a id="aa6d844dd0b4dfd93bd6d9d7efe7190da"></a>uint64_t</td>
<td class="fieldname">
num_reads</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a2db181c225b4fc956582c3601bc0aa74"></a>uint64_t</td>
<td class="fieldname">
num_writes</td>
<td class="fielddoc">
Number of messages read from the queue. </td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ad4129aa7dce3618a3ceb38daa7509667"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4129aa7dce3618a3ceb38daa7509667">&#9670;&nbsp;</a></span>Queue()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html">zeek::threading::Queue</a>&lt; T &gt;::<a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html">Queue</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/dd9/classzeek_1_1threading_1_1BasicThread.html">BasicThread</a> *&#160;</td>
          <td class="paramname"><em>arg_reader</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/dd9/classzeek_1_1threading_1_1BasicThread.html">BasicThread</a> *&#160;</td>
          <td class="paramname"><em>arg_writer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructor.</p>
<p>reader, writer: The corresponding threads. This is for checking whether they have terminated so that we can abort I/O opeations. Can be left null for the main thread. </p>

</div>
</div>
<a id="abd54229d9c319ffc7936fd67288c417a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd54229d9c319ffc7936fd67288c417a">&#9670;&nbsp;</a></span>~Queue()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html">zeek::threading::Queue</a>&lt; T &gt;::~<a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html">Queue</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Destructor. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a2ab27903a2888ca6b783dd9475d773e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ab27903a2888ca6b783dd9475d773e2">&#9670;&nbsp;</a></span>Get()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T <a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html">zeek::threading::Queue</a>&lt; T &gt;::Get</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Retrieves one element. This may block for a little while of no input is available and eventually return with a null element if nothing shows up. </p>

</div>
</div>
<a id="a7ea4414e72a215078b67d96cfdc54233"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ea4414e72a215078b67d96cfdc54233">&#9670;&nbsp;</a></span>GetStats()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html">zeek::threading::Queue</a>&lt; T &gt;::GetStats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#dc/d12/structzeek_1_1threading_1_1Queue_1_1Stats">Stats</a> *&#160;</td>
          <td class="paramname"><em>stats</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns statistics about the queue's usage.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stats</td><td>A pointer to a structure that will be filled with current numbers. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4a679929ea52b2151d519c856df434c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a679929ea52b2151d519c856df434c9">&#9670;&nbsp;</a></span>LocksForAllQueues()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::unique_lock&lt; std::mutex &gt; &gt; <a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html">zeek::threading::Queue</a>&lt; T &gt;::LocksForAllQueues</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a809c05aa6cbbfd87e78a72ebbdceed5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a809c05aa6cbbfd87e78a72ebbdceed5b">&#9670;&nbsp;</a></span>MaybeReady()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html">zeek::threading::Queue</a>&lt; T &gt;::MaybeReady </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns true if the next <a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#a2ab27903a2888ca6b783dd9475d773e2">Get()</a> operation might succeed. This function may occasionally return a value not indicating the actual state, but won't do so very often. Note that this means that it can consistently return false even if there is something in the <a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html">Queue</a>. You have to check real queue status from time to time to be sure that it is empty. In other words, this method helps to avoid locking the queue frequently, but doesn't allow you to forgo it completely. </p>

</div>
</div>
<a id="a1f0111fb50c4fdd8703a8c2bc4d945f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f0111fb50c4fdd8703a8c2bc4d945f6">&#9670;&nbsp;</a></span>Put()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html">zeek::threading::Queue</a>&lt; T &gt;::Put </td>
          <td>(</td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Queues one element. </p>

</div>
</div>
<a id="a20a43630a2e24bcfe03cf899056daed0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20a43630a2e24bcfe03cf899056daed0">&#9670;&nbsp;</a></span>Ready()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html">zeek::threading::Queue</a>&lt; T &gt;::Ready</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns true if the next <a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#a2ab27903a2888ca6b783dd9475d773e2">Get()</a> operation will succeed. </p>

</div>
</div>
<a id="af73087b9d59a21825e959003864c9a02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af73087b9d59a21825e959003864c9a02">&#9670;&nbsp;</a></span>Size()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t <a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html">zeek::threading::Queue</a>&lt; T &gt;::Size</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the number of queued items not yet retrieved. </p>

</div>
</div>
<a id="a63519d754733c6706b1bfea2a6027c2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63519d754733c6706b1bfea2a6027c2d">&#9670;&nbsp;</a></span>WakeUp()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html">zeek::threading::Queue</a>&lt; T &gt;::WakeUp</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Wake up the reader if it's currently blocked for input. This is primarily to give it a chance to check termination quickly. </p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ae18e6e465f1d2c5b865df959cf01977c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae18e6e465f1d2c5b865df959cf01977c">&#9670;&nbsp;</a></span>has_data</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::condition_variable <a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html">zeek::threading::Queue</a>&lt; T &gt;::has_data[<a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#a7afbd89d22346851ec0caa1ae7d4e547">NUM_QUEUES</a>]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a107c47a5ed4d3dd0fef8a51af629befd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a107c47a5ed4d3dd0fef8a51af629befd">&#9670;&nbsp;</a></span>messages</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::queue&lt;T&gt; <a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html">zeek::threading::Queue</a>&lt; T &gt;::messages[<a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#a7afbd89d22346851ec0caa1ae7d4e547">NUM_QUEUES</a>]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a27e7cca9388d3f4dff9f6e007e453b8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27e7cca9388d3f4dff9f6e007e453b8c">&#9670;&nbsp;</a></span>mutex</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::mutex <a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html">zeek::threading::Queue</a>&lt; T &gt;::mutex[<a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html#a7afbd89d22346851ec0caa1ae7d4e547">NUM_QUEUES</a>]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7afbd89d22346851ec0caa1ae7d4e547"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7afbd89d22346851ec0caa1ae7d4e547">&#9670;&nbsp;</a></span>NUM_QUEUES</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int <a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html">zeek::threading::Queue</a>&lt; T &gt;::NUM_QUEUES = 8</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae9fdc030b2c7924fe4d0fe5569beabee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9fdc030b2c7924fe4d0fe5569beabee">&#9670;&nbsp;</a></span>num_reads</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t <a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html">zeek::threading::Queue</a>&lt; T &gt;::num_reads</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae8c6521a9090d3ca77490c84a0d09a16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8c6521a9090d3ca77490c84a0d09a16">&#9670;&nbsp;</a></span>num_writes</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t <a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html">zeek::threading::Queue</a>&lt; T &gt;::num_writes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad6d787a4235e1705b49e96dc08375cb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6d787a4235e1705b49e96dc08375cb5">&#9670;&nbsp;</a></span>read_ptr</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html">zeek::threading::Queue</a>&lt; T &gt;::read_ptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a43e75969c20576fbc132d40081f63983"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43e75969c20576fbc132d40081f63983">&#9670;&nbsp;</a></span>reader</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d3/dd9/classzeek_1_1threading_1_1BasicThread.html">BasicThread</a>* <a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html">zeek::threading::Queue</a>&lt; T &gt;::reader</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a81e668042a80a20af0f61154acd0d4fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81e668042a80a20af0f61154acd0d4fd">&#9670;&nbsp;</a></span>write_ptr</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html">zeek::threading::Queue</a>&lt; T &gt;::write_ptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="acbb4d8df360a3bfccaba747388882fc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbb4d8df360a3bfccaba747388882fc0">&#9670;&nbsp;</a></span>writer</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d3/dd9/classzeek_1_1threading_1_1BasicThread.html">BasicThread</a>* <a class="el" href="../../dd/dd1/classzeek_1_1threading_1_1Queue.html">zeek::threading::Queue</a>&lt; T &gt;::writer</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/root/zeek/src/threading/<a class="el" href="../../db/d7a/threading_2Queue_8h_source.html">Queue.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
